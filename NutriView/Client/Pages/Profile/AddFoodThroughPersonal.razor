@page "/PersonalFoodLink/create/{foodentryid:int}"
@using NutriView.Shared.Domain;
@inject HttpClient _client
@inject NavigationManager _navManager
@using NutriView.Client.Pages.EntryLinkFood_CRUD;

<h3 class="card-title">Create New NutritionalQuota for </h3>
<hr />
<br />

<ELFFormComponent ButtonText="Create EntryLinkFood" foodentryid="foodentryid" entryLinkFood="entryLinkFood" OnValidSubmit="@CreateEntryLinkFood" @ref="foodentrylinkref" AddingFoodThroughProfile="@AddingFoodThroughProfile" />
@code {
    [Parameter] public bool AddingFoodThroughProfile { get; set; } = true;
    [Parameter] public int foodentryid { get; set; }

    private ELFFormComponent foodentrylinkref;

    EntryLinkFood entryLinkFood = new EntryLinkFood();

    private IList<FoodEntry>? Foodentries;
    private IList<Food>? Foods;

    protected override async Task OnInitializedAsync()
    {
        Foodentries = await _client.GetFromJsonAsync<List<FoodEntry>>($"{Endpoints.FoodEntriesEndpoint}");
        Foods = await _client.GetFromJsonAsync<List<Food>>($"{Endpoints.FoodsEndpoint}");
    }

    private async Task CreateEntryLinkFood()
    {
        await _client.PostAsJsonAsync(Endpoints.EntryLinkFoodsEndpoint, entryLinkFood);
        _navManager.NavigateTo("/entryLinkFoods/");
    }

}
